### 阅读重点

* eureka-client 初始化
* eureka-server 启动
* 注册表关系，主要类 InstanceRegistry
* 应用实例 -- 注册 :Eureka-Client 向 Eureka-Server 发起注册
* 应用实例 -- 续租 ：eureka-Client 向 Eureka-Server 发起注册应用实例成功后获得租约 ( Lease )
* 应用实例 -- 下线 ： Eureka-Client 向 Eureka-Server 发起下线应用实例
* 应用实例 -- 自我保护机制
* 应用实例 -- 过期 ：应用实例可能异常崩溃，又或者是网络异常等原因，导致下线请求无法被成功提交。
* 应用实例 -- 全量获取
* 应用实例 -- 增量获取
* 应用实例 -- 覆盖状态
* 应用实例 -- 读写锁
* 应用实例 -- 任务批处理
* 应用实例 -- 网络通信
* 应用实例 -- 集群同步
* 应用实例 -- 令牌桶算法RateLimiter
* 应用实例 -- 缓存


### 要点
 
 * 默认配置下，Eureka-Client 启动时，首先执行一次全量获取进行本地缓存注册信息，而后每 30 秒增量获取刷新本地缓存( 非“正常”情况下会是全量获取 )。
 * Eureka-Client 在初始化过程中，创建获取注册信息线程，固定间隔向 Eureka-Server 发起获取注册信息( fetch )，刷新本地注册信息缓存
 * 全量获取的条件：
 
 
      配置 eureka.disableDelta = true ，禁用增量获取注册信息。默认值：false 。
      只获得一个 vipAddress 对应的应用实例们的注册信息
      方法参数 forceFullRegistryFetch 强制全量获取注册信息
      本地缓存为空
      调用 #getAndStoreFullRegistry() 方法，全量获取注册信息，并设置到本地缓存。
      
* 缓存过期策略


    应用实例注册、下线、过期时，只只只过期 readWriteCacheMap 。
    readWriteCacheMap 写入一段时间( 可配置 )后自动过期。
    定时任务对比 readWriteCacheMap 和 readOnlyCacheMap 的缓存值，若不一致，以前者为主。通过这样的方式，实现了 readOnlyCacheMap 的定时过期。
    